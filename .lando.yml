name: vss
recipe: acquia
config:
  acli_version: latest
  ah_application_uuid: 249931c2-c947-4980-b6e4-953c4206177c
  ah_site_group: vss2
  php: '7.4'
  via: apache
  webroot: docroot/
  database: mysql
  drush: ^10
  xdebug: false

services:
  vss:
    type: mysql
    portforward: true
    config:
      confd: lando/mysql/conf.d
  node:
    type: node:14
    build:
      - "cd /app && npm install && npm install -g gulp-cli"
  appserver:
    build:
      - "cd /app && composer install && phpcs --config-set installed_paths /app/vendor/drupal/coder/coder_sniffer"
    run:
      - echo "▶️  Updating Composer via self-update ..."
      - composer self-update
      - echo "▶️  Enable git core hookpath ..."
      - git config core.hooksPath .githooks
proxy:
  appserver:
    - vss.lndo.site
tooling:
  "drush":
    cmd: "/app/vendor/bin/drush --root=/app/docroot"
    description: "Runs drush command. Ex: lando drush _yourcommand_"
  "gulp":
    service: node
    cmd: "gulp"
  "npm":
    service: node
    cmd: "npm"
    description: "Runs npm for installing or removing modules. Ex: lando npm _yourcommand_"
  "compile:scss":
    service: node
    cmd: "gulp -f=gulpfile.js"
    description: "Converts scss to css. Ex: lando compile:scss <themes/watchthemes/lintthemes>"
  "phpcs":
    service: appserver
    cmd: "/app/vendor/bin/phpcs --standard=Drupal,DrupalPractice --extensions=php,module,inc,install,test,profile,theme,css,info,txt,md,yml --ignore=node_modules,bower_components,vendor"
    options:
    description: Runs Drupal Coding Standards for given folder or file. Ex. lando phpcs docroot/modules/custom/module
  "phpcbf":
    service: appserver
    cmd: "/app/vendor/bin/phpcbf --standard=Drupal,DrupalPractice --extensions=php,module,inc,install,test,profile,theme,css,info,txt,md,yml --ignore=node_modules,bower_components,vendor"
    options:
    description: Runs Drupal Coding Standards for given folder or file. Ex. lando phpcbf docroot/modules/custom/module
  "blt":
    service: appserver
    cmd: /app/vendor/bin/blt
    